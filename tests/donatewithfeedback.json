{
  "types": {
    "DonationInfo": [
      {"field": "seq", "type": "Int"},
      {"field": "donator", "type": "Agent"},
      {"field": "amount", "type": "Int"},
      {"field": "feedback", "type": "String"},
      {"field": "error", "type": "String"}
    ]
  },
  "setups": {
    "default": {
      "contract": {
        "name": "donatewithfeedback",
        "description": "Donate iotas and give feedback",
        "id": "@scId",
        "owner": "@scOwner"
      },
      "balances": {"#iota": 100},
      "timestamp": 20201027172138,
      "caller": "@caller"
    }
  },
  "tests": [
    {
      "name": "donateOnce",
      "setup": "default",
      "function": "donate",
      "incoming": {"#iota": 500},
      "params": {
        "f": "Here, have some iotas"
      },
      "expect": {
        "balances": {"#iota": 600},
        "state": {},
        "logs": {
          "l": [
            {
              "timestamp": 20201027172138,
              "data": {
                "DonationInfo": {
                  "seq": 0,
                  "donator": "@caller",
                  "amount": 500,
                  "feedback": "Here, have some iotas",
                  "error": ""
                }
              }
            }
          ]
        },
        "calls": [],
        "posts": [],
        "views": [],
        "transfers": []
      }
    },
    {
      "name": "donateTwice",
      "setup": "default",
      "function": "donate",
      "incoming": {"#iota": 500},
      "params": {
        "f": "Here, have some iotas"
      },
      "additionalRequests": [
        {
          "timestamp": 20201027172139,
          "caller": "@caller2",
          "function": "donate",
          "incoming": {"#iota": 750},
          "params": {
            "f": "Here, have some more iotas"
          }
        }
      ],
      "expect": {
        "balances": {"#iota": 1350},
        "state": {},
        "logs": {
          "l": [
            {
              "timestamp": 20201027172138,
              "data": {
                "DonationInfo": {
                  "seq": 0,
                  "donator": "@caller",
                  "amount": 500,
                  "feedback": "Here, have some iotas",
                  "error": ""
                }
              }
            },
            {
              "timestamp": 20201027172139,
              "data": {
                "DonationInfo": {
                  "seq": 1,
                  "donator": "@caller2",
                  "amount": 750,
                  "feedback": "Here, have some more iotas",
                  "error": ""
                }
              }
            }
          ]
        },
        "calls": [],
        "posts": [],
        "views": [],
        "transfers": []
      }
    },
    {
      "name": "donateAndWithdraw",
      "setup": "default",
      "function": "donate",
      "incoming": {"#iota": 500},
      "params": {
        "f": "Here, have some iotas"
      },
      "additionalRequests": [
        {
          "timestamp": 20201027172139,
          "caller": "@scOwner",
          "function": "withdraw",
          "params": {
            "s": 250
          }
        }
      ],
      "expect": {
        "balances": {"#iota": 350},
        "state": {},
        "logs": {
          "l": [
            {
              "timestamp": 20201027172138,
              "data": {
                "DonationInfo": {
                  "seq": 0,
                  "donator": "@caller",
                  "amount": 500,
                  "feedback": "Here, have some iotas",
                  "error": ""
                }
              }
            }
          ]
        },
        "calls": [],
        "posts": [],
        "views": [],
        "transfers": [
          {"agent": "@scOwner", "color": "#iota", "amount": 250}
        ]
      }
    },
    {
      "name": "donateAndWithdrawUnauthorized",
      "setup": "default",
      "function": "donate",
      "incoming": {"#iota": 500},
      "params": {
        "f": "Here, have some iotas"
      },
      "additionalRequests": [
        {
          "timestamp": 20201027172139,
          "caller": "@notScOwner",
          "function": "withdraw",
          "params": {
            "s": 250
          }
        }
      ],
      "expect": {
        "balances": {"#iota": 600},
        "state": {},
        "logs": {
          "l": [
            {
              "timestamp": 20201027172138,
              "data": {
                "DonationInfo": {
                  "seq": 0,
                  "donator": "@caller",
                  "amount": 500,
                  "feedback": "Here, have some iotas",
                  "error": ""
                }
              }
            }
          ]
        },
        "calls": [],
        "posts": [],
        "views": [],
        "transfers": []
      }
    },
    {
      "name": "donateTwiceAndView",
      "setup": "default",
      "function": "donate",
      "incoming": {"#iota": 500},
      "params": {
        "f": "Here, have some iotas"
      },
      "additionalRequests": [
        {
          "timestamp": 20201027172139,
          "caller": "@caller2",
          "function": "donate",
          "incoming": {"#iota": 750},
          "params": {
            "f": "Here, have some more iotas"
          }
        },
        {
          "timestamp": 20201027172139,
          "caller": "@caller3",
          "function": "viewDonations"
        }
      ],
      "expect": {
        "balances": {"#iota": 1350},
        "state": {},
        "logs": {
          "l": [
            {
              "timestamp": 20201027172138,
              "data": {
                "DonationInfo": {
                  "seq": 0,
                  "donator": "@caller",
                  "amount": 500,
                  "feedback": "Here, have some iotas",
                  "error": ""
                }
              }
            },
            {
              "timestamp": 20201027172139,
              "data": {
                "DonationInfo": {
                  "seq": 1,
                  "donator": "@caller2",
                  "amount": 750,
                  "feedback": "Here, have some more iotas",
                  "error": ""
                }
              }
            }
          ]
        },
        "calls": [],
        "posts": [],
        "views": [],
        "transfers": [],
        "results": {
          "largest": 750,
          "total": 1250,
          "donations": [
            {
              "timestamp": 20201027172138,
              "donator": "@caller",
              "amount": 500,
              "feedback": "Here, have some iotas",
              "error": ""
            },
            {
              "timestamp": 20201027172139,
              "donator": "@caller2",
              "amount": 750,
              "feedback": "Here, have some more iotas",
              "error": ""
            }
          ]
        }
      }
    }
  ]
}
